!function(t){"use strict";var r=function(){var t=function(t,r,n,o,e,i){for(var f=n.length,a=0;f--;)for(var u=n[f][0],s=n[f][1];u!==s;){var l=o[u][s];i.push(t.eadd(r[u],r[l],e[u][l])),u=l,++a}return a};return t};t.dup_t=r;var n=function(){var t=function(t,r,n,o,e,i,f){for(var a,u,s=[n,0],l=[];;){for(;o[s[0]];){if(!l.length)return;s=l.pop()}for(n=s[0],u=s[1],a=r[n],o[n]=!0;;){var h=!0;if(e[n]=t.eitr(a,function(t,r){return t.free?(i.splice(u,0,n),f.splice(u,0,t),a=r,++u,o[a[0]]||l.push([a[0],u]),t.free=!1,h=!1,n=a[0],!0):void 0},e[n]),h)break}}};return t};t.eventour_t=n;var o=function(){var t=function(t,r,n){var o=[];t.vitr(function(e){var i=0;if(t.eitr(e,function(t,r){i+=r!==e}),i%2===1){for(var f=n.vadd(e),a=o.length;a--;)n.eadd(f,o[a],r[e[0]][o[a][1][0]]);o.push(f)}})};return t};t.oddgraph_t=o;var e=function(){var t=function(t,r,n,o){var e,i,f=[];for(t.vitr(function(r){e=r[0],f[e]=o.vadd(r),t.eitr(r,function(t,r,o){i=r[0],e>=i||o<n[e][i]&&(n[e][i]=o)})}),e=0;r>e;++e)for(i=e+1;r>i;++i)n[e][i]<1/0&&o.eadd(f[e],f[i],n[e][i]);return f};return t};t.simplegraph_t=e;var i=function(t,r,n){var o=t?function(t){console.log("DEBUG:",t)}:null;void 0===n&&(n=!1),void 0===r&&(r=!0);var e=function(t){if(!t)throw new Error("Assertion failed")},i=function(t,r,n){for(var o=t[r];--n>r;)t[n]<o&&(o=t[n]);return o},f=function(t,r){var n=t[0].length<t[1].length?t[0]:t[1];n.map(function(n,o){r.apply(null,t.map(function(t){return t[o]}))})},a=function(t,a){var u,s,l,h,p,v;if(void 0===a&&(a=!1),!t.length)return[];var d=t.length,c=0,g=0;for(v=d;v--;)u=t[v][0],s=t[v][1],p=t[v][2],e(u>=0&&s>=0&&u!==s),u>=c&&(c=u+1),s>=c&&(c=s+1),g=Math.max(g,p);h=2*d;for(var y=new Array(h);h--;)y[h]=t[Math.floor(h/2)][h%2];u=c;for(var b=new Array(u);u--;)b[u]=[];for(l=0;d>l;++l)u=t[l][0],s=t[l][1],b[u].push(2*l+1),b[s].push(2*l);u=c;for(var m=new Array(u);u--;)m[u]=-1;u=2*c;for(var A=new Array(u);u--;)A[u]=0;u=2*c;for(var w=new Array(u);u--;)w[u]=-1;u=c;for(var j=new Array(u);u--;)j[u]=u;u=2*c;for(var M=new Array(u);u--;)M[u]=-1;u=2*c;for(var _=new Array(u);u--;)_[u]=null;v=2*c;var k=new Array(v);for(u=0;c>u;++u)k[u]=u;for(;v>u;++u)k[u]=-1;u=2*c;for(var G=new Array(u);u--;)G[u]=null;u=2*c;for(var x=new Array(u);u--;)x[u]=-1;u=2*c;for(var B=new Array(u);u--;)B[u]=null;u=c;for(var P=new Array(u);u--;)P[u]=c+u;v=2*c;var E=new Array(v);for(u=0;c>u;++u)E[u]=g;for(;v>u;++u)E[u]=0;u=d;for(var S=new Array(u);u--;)S[u]=!1;var I,O,R,U,T,q,D,H,L,z,C,F,J,K=[],N=function(r){var n=t[r][0],o=t[r][1],e=t[r][2];return E[n]+E[o]-2*e},Q=function(t,r){if(c>t){if(r(t))return!0}else{var n,o,e;for(n=_[t].length,o=0;n>o;++o)if(e=_[t][o],c>e){if(r(e))return!0}else if(Q(e,r))return!0}},V=function(t,r,n){o&&o("assignLabel("+t+","+r+","+n+")");var i=j[t];if(e(0===A[t]&&0===A[i]),A[t]=A[i]=r,w[t]=w[i]=n,x[t]=x[i]=-1,1===r)Q(i,function(t){K.push(t)}),o&&o("PUSH "+K);else if(2===r){var f=k[i];e(m[f]>=0),V(y[m[f]],1,1^m[f])}},W=function(t,r){o&&o("scanBlossom("+t+","+r+")");for(var n,i,f,a=[],u=-1;-1!==t||-1!==r;){if(n=j[t],4&A[n]){u=k[n];break}e(1===A[n]),a.push(n),A[n]=5,e(w[n]===m[k[n]]),-1===w[n]?t=-1:(t=y[w[n]],n=j[t],e(2===A[n]),e(w[n]>=0),t=y[w[n]]),-1!==r&&(i=t,t=r,r=i)}for(f=a.length;f--;)n=a[f],A[n]=1;return u},X=function(r,n){var i,f,a,u,s,l,h,p,v,d,g,S,I=t[n][0],O=t[n][1],R=t[n][2],U=j[r],T=j[I],q=j[O],D=P.pop();o&&o("addBlossom("+r+","+n+") (v="+I+" w="+O+") -> "+D),k[D]=r,M[D]=-1,M[U]=D;for(var H=_[D]=[],L=G[D]=[];T!==U;)M[T]=D,H.push(T),L.push(w[T]),e(2===A[T]||1===A[T]&&w[T]===m[k[T]]),e(w[T]>=0),I=y[w[T]],T=j[I];for(H.push(U),H.reverse(),L.reverse(),L.push(2*n);q!==U;)M[q]=D,H.push(q),L.push(1^w[q]),e(2===A[q]||1===A[q]&&w[q]===m[k[q]]),e(w[q]>=0),O=y[w[q]],q=j[O];for(e(1===A[U]),A[D]=1,w[D]=w[U],E[D]=0,Q(D,function(t){2===A[j[t]]&&K.push(t),j[t]=D}),h=2*c,S=new Array(h);h--;)S[h]=-1;for(a=H.length,h=0;a>h;++h){for(T=H[h],null===B[T]?(g=[],Q(T,function(t){for(f=b[t].length,u=new Array(f);f--;){var r=b[t][f];u[f]=Math.floor(r/2)}g.push(u)})):g=[B[T]],s=0,p=g.length;p>s;++s)for(d=g[s],l=0,v=d.length;v>l;++l){n=d[l],i=t[n][0],f=t[n][1],R=t[n][2],j[f]===D&&(u=i,i=f,f=u);var z=j[f];z!==D&&1===A[z]&&(-1===S[z]||N(n)<N(S[z]))&&(S[z]=n)}B[T]=null,x[T]=-1}for(B[D]=[],a=S.length,i=0;a>i;++i)n=S[i],-1!==n&&B[D].push(n);if(a=B[D].length,a>0)for(x[D]=B[D][0],i=1;a>i;++i)n=B[D][i],N(n)<N(x[D])&&(x[D]=n);else x[D]=-1;o&&o("blossomchilds["+D+"]="+_[D])},Y=function(t,r){o&&o("expandBlossom("+t+","+r+") "+_[t]);var n,i,f,a,u,s,l,h,p,v;for(n=0;n<_[t].length;++n)f=_[t][n],M[f]=-1,c>f?j[f]=f:r&&0===E[f]?Y(f,r):Q(f,function(t){j[t]=f});if(!r&&2===A[t]){for(e(w[t]>=0),u=j[y[1^w[t]]],i=_[t].indexOf(u),1&i?(s=1,l=0,p=_[t].length,v=0):(s=-1,l=1,p=0,v=_[t].length),a=w[t];i!==p;)A[y[1^a]]=0,A[y[G[t][i-l]^l^1]]=0,V(y[1^a],2,a),S[Math.floor(G[t][i-l]/2)]=!0,i+=s,a=G[t][i-l]^l,S[Math.floor(a/2)]=!0,i+=s;for(h=_[t][0],A[y[1^a]]=A[h]=2,w[y[1^a]]=w[h]=a,x[h]=-1,i=v+s;_[t][i]!==u;)h=_[t][i],1!==A[h]?(Q(h,function(t){return 0!==A[t]?(e(2===A[t]),e(j[t]===h),A[t]=0,A[y[m[k[h]]]]=0,V(t,2,w[t]),!0):void 0}),i+=s):i+=s}A[t]=w[t]=-1,_[t]=G[t]=null,k[t]=-1,B[t]=null,x[t]=-1,P.push(t)},Z=function(t,r){for(var n=t.splice(0,r),o=0;r>o;++o)t.push(n[o])},$=function(t,r){o&&o("augmentBlossom("+t+","+r+")");var n,i,f,a,u,s,l,h;for(f=r;M[f]!==t;)f=M[f];for(f>=c&&$(f,r),n=i=_[t].indexOf(f),l=_[t].length,1&n?(a=1,u=0,s=l):(a=-1,u=1,s=0);i!==s;)i+=a,f=_[t][i],h=G[t][i-u]^u,f>=c&&$(f,y[h]),i+=a,f=_[t][Math.abs(i%l)],f>=c&&$(f,y[1^h]),m[y[h]]=1^h,m[y[1^h]]=h,o&&o("PAIR "+y[h]+" "+y[1^h]+" (k="+Math.floor(h/2)+")");Z(_[t],n),Z(G[t],n),k[t]=k[_[t][0]],e(k[t]===r)},tr=function(r){{var n,i,f,a,u=t[r][0],s=t[r][1];t[r][2]}o&&o("augmentMatching("+r+") (v="+u+" w="+s+")"),o&&o("PAIR "+u+" "+s+" (k="+r+")"),[[u,2*r+1],[s,2*r]].forEach(function(t){for(var r=t[0],u=t[1];;){if(n=j[r],e(1===A[n]),e(w[n]===m[k[n]]),n>=c&&$(n,r),m[r]=u,-1===w[n])break;i=y[w[n]],f=j[i],e(2===A[f]),e(w[f]>=0),r=y[w[f]],a=y[1^w[f]],e(k[f]===i),f>=c&&$(f,a),m[a]=w[f],u=1^w[f],o&&o("PAIR "+r+" "+i+" (k="+Math.floor(u/2)+")")}})},rr=function(){var r,n,o,u,s,l,h,p,v;for(v=a?Math.max(0,-i(E,0,c)):0,e(i(E,0,c)+v>=0),e(i(E,c,2*c)>=0),h=0;d>h;++h){for(r=t[h][0],n=t[h][1],o=t[h][2],p=E[r]+E[n]-2*o,iblossoms=[r],jblossoms=[n];-1!==M[iblossoms[iblossoms.length-1]];)iblossoms.push(M[iblossoms[iblossoms.length-1]]);for(;-1!==M[jblossoms[jblossoms.length-1]];)jblossoms.push(M[jblossoms[jblossoms.length-1]]);iblossoms.reverse(),jblossoms.reverse(),f([iblossoms,jblossoms],function(t,r){return t!==r?!0:void(p+=2*E[t])}),e(p>=0),(Math.floor(m[r]/2)===h||Math.floor(m[n]/2)===h)&&(e(Math.floor(m[r]/2)===h&&Math.floor(m[n]/2)===h),e(0===p))}for(u=0;c>u;++u)e(m[u]>=0||E[u]+v===0);for(s=c;2*c>s;++s)if(k[s]>=0&&E[s]>0)for(e(G[s].length%2===1),r=1;r<G[s].length;r+=2)l=G[s][r],e(m[y[l]]===l^1),e(m[y[1^l]]===l)},nr=function(){for(var t=0;c>t;++t)if(0===A[j[t]]){for(var r=null,n=-1,i=0;i<b[t].length;++i){var f=b[t][i],a=Math.floor(f/2),u=y[f];if(1===A[j[u]]){var s=N(a);(-1===n||r>s)&&(n=a,r=s)}}!o||-1===x[t]&&-1===n||-1!==x[t]&&r===N(x[t])||o("v="+t+" bk="+n+" bd="+r+" bestedge="+x[t]+" slack="+N(x[t])),e(-1===n&&-1===x[t]||-1!==x[t]&&r===N(x[t]))}},or=function(){for(var r=-1,n=null,i=-1,f=null,a=0;2*c>a;++a)if(-1===M[a]&&1===A[a]&&(Q(a,function(t){for(var o=0;o<b[t].length;++o){var e=b[t][o],i=Math.floor(e/2),f=y[e];if(j[f]!==a&&1===A[j[f]]){var u=N(i);(-1===r||n>u)&&(r=i,n=u)}}}),-1!==x[a])){{var u=t[x[a]][0],s=t[x[a]][1];t[x[a]][2]}e(j[u]===a||j[s]===a),e(j[u]!==a||j[s]!==a),e(1===A[j[u]]&&1===A[j[s]]),(-1===i||N(x[a])<f)&&(i=x[a],f=N(x[a]))}o&&n!==f&&o("bk="+r+" tbk="+i+" bd="+n+" tbd="+f),e(n===f)};for(R=0;c>R;++R){for(o&&o("STAGE "+R),u=2*c;u--;)A[u]=0;for(u=2*c;u--;)x[u]=-1;for(u=c;u--;)B[c+u]=null;for(u=d;u--;)S[u]=!1;for(K=[],U=0;c>U;++U)-1===m[U]&&0===A[j[U]]&&V(U,1,-1);for(T=0;;){for(o&&o("SUBSTAGE");K.length&&!T;)for(U=K.pop(),o&&o("POP v="+U),e(1===A[j[U]]),v=b[U].length,u=0;v>u;++u)if(h=b[U][u],l=Math.floor(h/2),p=y[h],j[U]!==j[p])if(S[l]||(q=N(l),0>=q&&(S[l]=!0)),S[l])if(0===A[j[p]])V(p,2,1^h);else if(1===A[j[p]]){if(D=W(U,p),!(D>=0)){tr(l),T=1;break}X(D,l)}else 0===A[p]&&(e(2===A[j[p]]),A[p]=2,w[p]=1^h);else 1===A[j[p]]?(I=j[U],(-1===x[I]||q<N(x[I]))&&(x[I]=l)):0===A[p]&&(-1===x[p]||q<N(x[p]))&&(x[p]=l);if(T)break;for(H=-1,L=z=C=null,n&&(nr(),or()),a||(H=1,L=i(E,0,c)),U=0;c>U;++U)0===A[j[U]]&&-1!==x[U]&&(O=N(x[U]),(-1===H||L>O)&&(L=O,H=2,z=x[U]));for(I=0;2*c>I;++I)-1===M[I]&&1===A[I]&&-1!==x[I]&&(q=N(x[I]),O=q/2,(-1===H||L>O)&&(L=O,H=3,z=x[I]));for(I=c;2*c>I;++I)k[I]>=0&&-1===M[I]&&2===A[I]&&(-1===H||E[I]<L)&&(L=E[I],H=4,C=I);for(-1===H&&(e(a),H=1,L=Math.max(0,i(E,0,c))),U=0;c>U;++U)1===A[j[U]]?E[U]-=L:2===A[j[U]]&&(E[U]+=L);for(I=c;2*c>I;++I)k[I]>=0&&-1===M[I]&&(1===A[I]?E[I]+=L:2===A[I]&&(E[I]-=L));if(o&&o("delta"+H+"="+L),1===H)break;2===H?(S[z]=!0,u=t[z][0],s=t[z][1],F=t[z][2],0===A[j[u]]&&(J=u,u=s,s=J),e(1===A[j[u]]),K.push(u)):3===H?(S[z]=!0,u=t[z][0],s=t[z][1],F=t[z][2],e(1===A[j[u]]),K.push(u)):4===H&&Y(C,!1)}if(!T)break;for(I=c;2*c>I;++I)-1===M[I]&&k[I]>=0&&1===A[I]&&0===E[I]&&Y(I,!0)}for(r&&rr(),U=0;c>U;++U)m[U]>=0&&(m[U]=y[m[U]]);for(U=0;c>U;++U)e(-1===m[U]||m[m[U]]===U);return m};return a};t.wblossom_n3_t=i;var f=function(t){var r=function(r,n,o,e,i,f,a){var u=function(t,r){return i[t[0]]<i[r[0]]},s=t(u),l=new s;for(f[o[0]]=!0,a[o[0]]=!0,r.eitr(o,function(t,r,n){i[r[0]]=n,a[r[0]]=!0,l.push(r)});l.length;){var h=l.pop();f[h[0]]=!0,r.eitr(h,function(t,r,n){var o=r;if(!f[o[0]]){var u=i[h[0]]+n;u<i[o[0]]&&(i[o[0]]=u,e[o[0]]=h[0]),a[o[0]]||(l.push(o),a[o[0]]=!0)}})}};return r};t.dijkstra_t=f;var a=function(){var t=function(t,r){var n,o,e;for(e=0;t>e;++e)for(n=0;t>n;++n)for(o=0;t>o;++o)r[n][e]+r[e][o]<r[n][o]&&(r[n][o]=r[n][e]+r[e][o])};return t};t.floyd_t=a;var u=function(){var t=function(r,n,o,e,i){r.eitr([e],function(f,a,u){a=a[0],o[a][i]===u+o[e][i]&&-1===n[a][i]&&(n[a][i]=e,t(r,n,o,a,i))})},r=function(r,n,o,e){for(var i=0;n>i;++i)e[i][i]=0,t(r,o,e,i,i)};return r};t.sptreedfs_t=u;var s=function(){var t=function(t,r,n){t.vitr(function(r){t.eitr(r,function(t,o,e){n[r[0]][o[0]]=e})})};return t};t.amat_t=s;var l=function(){var t=function(t,r){t.vitr(function(t){t.copy=r.vadd(t)}),t.aeitr(function(t,n,o,e){r.eadd(n.copy,o.copy,e)})};return t};t.copy_t=l;var h=function(t,r,n){t.vitr(function(t){n[t[0]]=r.vadd(t[0])}),t.vitr(function(o){t.eitr(o,function(t,e,i){o[0]<=e[0]&&r.eadd(n[o[0]],n[e[0]],i)})})};t.d2s=h;var p=function(t,r,n){var o=r,e=new Array(o);if(1===t)for(;o--;)e[o]=n;else for(;o--;)e[o]=p(t-1,r,n);return e};t.sqmat=p;var v=function(){var t=function(){this.pt=[],this.ad=[]};return t.prototype.vadd=function(t){var r=this.pt.length,n=[r,t];this.ad.push(n);for(var o=r;o--;)this.pt[o].push([null,null,-1]);for(this.pt.push(new Array(r+1)),o=r;o--;)this.pt[r][o]=this.pt[o][r];return this.pt[r][r]=[null,null,-1],n},t.prototype.vdel=function(t){var r=t[0];this.ad.splice(r,1),this.pt.splice(r,1);for(var n=this.pt.length,o=n;o--;)this.pt[o].splice(r,1);for(;n>r;++r)--this.ad[r][0]},t.prototype.eadd=function(t,r,n){var o=t[0],e=r[0];return this.pt[o][e][0]=t,this.pt[o][e][1]=r,this.pt[o][e][2]=n,this.pt[o][e]},t.prototype.edel=function(t){var r=t[0][0],n=t[1][0];this.pt[r][n][0]=null,this.pt[r][n][1]=null,this.pt[r][n][2]=-1},t.prototype.vitr=function(t){for(var r=0,n=this.ad.length;n>r&&!t.call(this,this.ad[r]);++r);},t.prototype.eitr=function(t,r){for(var n=t[0],o=0,e=this.pt[n].length;e>o&&(null===this.pt[n][o][0]||!r.call(this,this.pt[n][o],this.ad[o],this.pt[n][o][2]));++o);},t.prototype.aeitr=function(t,r){var n,o,e=this.ad.length;for(void 0===r&&(r=0),o=r%e,n=(r-o)/e;e>n;o=++n)for(;e>o;++o)if(null!==this.pt[n][o][0]&&t.call(this,this.pt[n][o],this.ad[n],this.ad[o],this.pt[n][o][2]))return n*e+o+1+(o+1===e)*(n+1);return e*e},t.prototype.aeend=function(){return this.ad.length*this.ad.length},t};t.dense_graph_t=v;var d=function(){var t=function(){this.obj=Array.prototype.slice.call(arguments)};return t.prototype.vadd=function(t){for(var r=0,n=this.obj.length,o=new Array(n);n>r;++r)o[r]=this.obj[r].vadd(t),o[r].pt=o;return o.pt=o,o},t.prototype.eadd=function(t,r,n){for(var o=0,e=this.obj.length,i=new Array(e);e>o;++o)i[o]=this.obj[o].eadd(t.pt[o],r.pt[o],n),i[o].pt=i;return i.pt=i,i},t.prototype.vdel=function(t){for(var r=0,n=this.obj.length;n>r;++r)this.obj[r].vdel(t.pt[r])},t.prototype.edel=function(t){for(var r=0,n=this.obj.length;n>r;++r)this.obj[r].edel(t.pt[r])},t};t.fuse_t=d;var c=function(){var t=function(t,r){this.G=t,this.ad=[],this.attr=void 0!==r?r:0};return t.prototype.vadd=function(){var t=this.ad.length;return this.ad.push(this.G.vadd(t)),this.ad[t]},t.prototype.vdel=function(t){this.G.vdel(t);var r=this.attr,n=t[r];this.ad.splice(n,1);for(var o=this.ad.length;o>n;++n)--this.ad[n][r]},t.prototype.eadd=function(t,r,n){return this.G.eadd(t,r,n)},t.prototype.edel=function(t){this.G.edel(t)},t.prototype.vitr=function(t){return this.G.vitr(t)},t.prototype.eitr=function(t,r,n){return this.G.eitr(t,r,n)},t.prototype.aeitr=function(t,r){return this.G.aeitr(t,r)},t.prototype.aeend=function(){return this.G.aeend()},t};t.index_t=c;var g=function(){var t=function(){this.beg=[null,null,null],this.end=[null,this.beg,null],this.beg[2]=this.end,this.ebeg=[null,null,-1,null,null],this.eend=[null,null,-1,this.ebeg,null],this.ebeg[4]=this.eend};return t.prototype.vadd=function(t){return this.end[1]=[t,this.end[1],this.end,[null,-1,null,null]],this.end[1][1][2]=this.end[1],this.end[1]},t.prototype.vdel=function(t){this.eitr(t,function(t){this.edel(t)}),t[1][2]=t[2],t[2][1]=t[1]},t.prototype.eadd=function(t,r,n){return t[3][3]=[r,n,t[3],t[3][3],null],null!==t[3][3][3]&&(t[3][3][3][2]=t[3][3]),r!==t&&(r[3][3]=[t,n,r[3],r[3][3],null],null!==r[3][3][3]&&(r[3][3][3][2]=r[3][3])),this.eend[3]=[t,r,n,this.eend[3],this.eend,t[3][3],r[3][3]],this.eend[3][3][4]=this.eend[3],t[3][3][4]=r[3][3][4]=this.eend[3],this.eend[3]},t.prototype.edel=function(t){t[5][2][3]=t[5][3],null!==t[5][3]&&(t[5][3][2]=t[5][2]),t[6]!==t[5]&&(t[6][2][3]=t[6][3],null!==t[6][3]&&(t[6][3][2]=t[6][2])),t[3][4]=t[4],t[4][3]=t[3]},t.prototype.vitr=function(t){for(var r=this.beg[2];r!==this.end&&!t.call(this,r);)r=r[2]},t.prototype.eitr=function(t,r,n){for(void 0===n&&(n=t[3][3]);null!==n;){if(r.call(this,n[4],n[0],n[1]))return n[3];n=n[3]}return n},t.prototype.aeitr=function(t,r){for(void 0===r&&(r=this.ebeg[4]);r!==this.eend;){if(t.call(this,r,r[0],r[1],r[2]))return r[4];r=r[4]}return r},t.prototype.aeend=function(){return this.eend},t};t.sparse_graph_t=g}("undefined"==typeof exports?this.gn={}:exports);